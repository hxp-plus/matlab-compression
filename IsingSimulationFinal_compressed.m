clear all;close all;clc;a2=0.1;a1=200;n=50;a3=n*n*a1;a4=floor((rand(n,n)-0.5).*2);for i=1:n;for j=1:n;if (a4(i,j)==0);a4(i,j)=1;end;end;end;for a14=1:a3;i=randi(n);j=randi(n);a6=0;a7=0;x=[i,mod(n+i-2,n)+1,i,mod(n+i,n)+1,i];y=[j,j,mod(n+j-2,n)+1,j,mod(n+j,n)+1];for k=1:5;a8=a4(mod(n+x(k)-2,n)+1,y(k))+a4(x(k),mod(n+y(k)-2,n)+1)+a4(mod(n+x(k),n)+1,y(k))+a4(x(k),mod(n+y(k),n)+1);a6=a6+(-1)*(a4(x(k),y(k)))*(a8);end;a6=a6/2;a10=(-1)*a4(i,j);a4(i,j)=a10;for k=1:5;a8=a4(mod(n+x(k)-2,n)+1,y(k))+a4(x(k),mod(n+y(k)-2,n)+1)+a4(mod(n+x(k),n)+1,y(k))+a4(x(k),mod(n+y(k),n)+1);a7=a7+(-1)*(a4(x(k),y(k)))*(a8);end;a7=a7/2;a11=-a7+a6;a12=exp(a11/a2);a13=rand(1,1);if (a12<a13);a4(i,j)=(-1)*a10;end;end;image((a4+1)*255),colormap(gray);axis square;